Part 1

In this project, we are using token-based authentication.

Part 2

Now we are going to refactor Auth.js.

There are two methods:

restrictToUserWithoutLogin

checkAuth

Both methods contain a lot of duplicate code.

To handle both cases (when a user is not null and when a user first visits the service), I’m creating a new function that manages these scenarios.

For this use case, I’m switching back to cookie-based authentication.

A user can have multiple roles:

Normal User – Can only view their own generated URLs.

Admin User – Can access all URLs generated by any user.

To generate a token, the user must go to the login page, which returns a token.

This generated token can then be used in Postman to access or view URLs.
